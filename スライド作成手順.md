##手順1.dialogues.jsonを作る
`script_final.md` には

- セクション見出し
    
- スライドメタ (`<!-- slide: ... -->`)
    
- セリフ（`- NARRATOR: ...`）  
が混ざっている。`script_final.md` からNARRATORの「セリフだけ」の配列を「dialogues.json」の名称で出力してください。出力形式は「dialogues-format.json」を参考にしてください。


##手順2. slides_plan.json を作る
スライド作成プロンプト（src\slide-pattern\slide-prompt-templete.md）を参照し、プロンプトの指示に従って「slides_plan0.json」を生成してください。 

##手順3.自動チューニング
「slides_plan.json」の結果が、「評価基準及びデータ（src\slide-pattern\templates.md）」に基づいて、妥当な結果になっているかを評価し、スライド作成プロンプトをチューニングしたプロンプトを「slide-prompt.md」として出力してください。

##手順4. slides_plan.json を作る
自動チューニングしたスライド作成プロンプト（src\slide-pattern\slide-prompt.md）を参照し、プロンプトの指示に従って「slides_plan.json」を生成してください。 


##手順5. json → Markdown →PDFに変換

Marpテンプレの中身（CSS / div / layout）に従ってslides_plan.jsonからslides_plan.mdを作成してほしい。

**重要: CSSスコープの設定（必須）**
- **Marpでは後に定義されたスタイルが前のスライドにも影響するため、クラススコープを使用すること**
- strong-messageスライド: `class: strong-message-slide` または `<!-- _class: strong-message-slide -->` を使用
- listスライド: `<!-- _class: list-slide -->` を使用
- すべてのCSSセレクタに `section.クラス名` を付けてスコープ化すること

**重要: 日本語フォント設定**
- 日本語の文字化けを防ぐため、すべてのCSS要素に `font-family` を設定すること
- **Canva互換性のため、Webフォント（@import）は使用しない**こと
- 推奨フォント（システムフォントのみ）: `font-family: "Yu Mincho", "Hiragino Mincho ProN", "MS PMincho", "Noto Serif JP", serif;`

**重要: Canva互換性のための制限**
- **text-shadowは使用しない**こと（Canvaで白背景ボックスとして誤認識される）
- **box-shadowは使用しない**こと
- **背景は単色を使用**すること（グラデーションは避ける）

**重要: Marpメタデータの記載ルール**
- Marpのメタデータは**最初のスライドにのみ**記載すること
- 2枚目以降のスライドは `---` のみで区切り、メタデータは記載しない
- **ページ番号を非表示にするため `paginate: false` を設定すること**

**テンプレート別の実装ルール:**

### 1. strong-messageスライド（1枚目の場合）
```markdown
---
marp: true
paginate: false
backgroundImage: url('../src/slide-pattern/makimono.png')
theme: default
class: strong-message-slide
---

<style>
section.strong-message-slide {
  font-family: "Yu Mincho", "Hiragino Mincho ProN", "MS PMincho", "Noto Serif JP", serif;
  display: flex;
  justify-content: center;
  align-items: center;
}

section.strong-message-slide .big-center {
  font-size: 64px;
  font-weight: 700;
  color: #ffffff;
  letter-spacing: 0.1em;
}
</style>

<!-- S001 -->
<div class="big-center">
タイトルテキスト
</div>
```

### 2. strong-messageスライド（2枚目以降の場合）
```markdown
---

<!-- _class: strong-message-slide -->

<style>
section.strong-message-slide {
  font-family: "Yu Mincho", "Hiragino Mincho ProN", "MS PMincho", "Noto Serif JP", serif;
  display: flex;
  justify-content: center;
  align-items: center;
}

section.strong-message-slide .big-center {
  font-size: 64px;
  font-weight: 700;
  color: #ffffff;
  letter-spacing: 0.1em;
}
</style>

<!-- S005 -->
<div class="big-center">
メッセージテキスト
</div>
```

### 3. list-3/4/5スライド（1枚目のlist-slideの場合）
```markdown
---

<!-- _class: list-slide -->

<style>
section.list-slide {
  font-family: "Yu Mincho", "Hiragino Mincho ProN", "MS PMincho", "Noto Serif JP", serif;
  color: #ffffff;
  font-size: 40px;
  padding: 24px 72px 40px 72px;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: flex-start;
  gap: 10px;
}

section.list-slide h1 {
  align-self: center;
  color: #ffffff;
  font-weight: 700;
  font-size: 55px;
  margin-top: 8px;
  margin-bottom: 24px;
  letter-spacing: 0.08em;
}

section.list-slide .list-index {
  display: inline-flex;
  justify-content: center;
  align-items: center;
  width: 52px;
  height: 52px;
  margin-right: 16px;
  border-radius: 50%;
  font-weight: 700;
  font-size: 32px;
  background: #d0bc89;
  color: #0d0701;
}

section.list-slide .list-item {
  display: flex;
  align-items: center;
  margin-bottom: 10px;
}
</style>

<!-- S002 -->
# タイトル

<div class="list-item">
  <div class="list-index">1</div>
  <div>項目1</div>
</div>
```

### 4. list-slideスライド（2枚目以降）
```markdown
---

<!-- _class: list-slide -->

<!-- S003 -->
# タイトル

<div class="list-item">
  <div class="list-index">1</div>
  <div>項目1</div>
</div>
```
**注意:** 2枚目以降のlist-slideでは、`<style>`タグは不要（1枚目で定義済み）

slides_plan.mdを作成するとき、イメージで書くと、TypeScript側にこんな感じのレンダラーを用意する：

``type BigCenterChalkboardConfig = {   template: "big_center_chalkboard";   section_id: string;   text: string; };  export function renderBigCenterChalkboard(   slide: BigCenterChalkboardConfig ): string {   return [     "---",     "marp: true",     "backgroundImage: url('chalkboard.png')",     "---",     "",     "<style>",     ".big-center {",     "  display: flex;",     "  justify-content: center;",     "  align-items: center;",     "  height: 500px;",     "  font-size: 64px;",     "  font-weight: 700;",     "  color: #ffffff;",     "  text-shadow: 0 0 8px rgba(0,0,0,0.7);",     "  font-family: \"Yu Gothic\", \"Hiragino Kaku Gothic ProN\", \"Meiryo\", sans-serif;",     "}",     "</style>",     "",     `<!-- ${slide.section_id} -->`,     "",     '<div class="big-center">',     slide.text,     "</div>"   ].join("\n"); }``

で、メインの変換側で：
`function renderSlide(slide: SlideConfig): string {   switch (slide.template) {     case "big_center_chalkboard":       return renderBigCenterChalkboard(slide);     // 他テンプレも case で分ける   } }`

。src\slide-pattern配下のテンプレの中身（CSS / div / layout）を参考にして。
そのあとに、`npx @marp-team/marp-cli slide-out/slides_plan.md -o slide-out/slides_plan.pdf --allow-local-files` コマンドでPDFを作成してほしい。

**重要: --allow-local-filesオプション**
- ローカルファイル（背景画像など）にアクセスする際は `--allow-local-files` オプションが必要
- このオプションを付けないと警告が表示される
- セキュリティリスクを理解した上で使用すること